<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="DaFlowPINN.post package" href="DaFlowPINN.post.html" /><link rel="prev" title="DaFlowPINN.config package" href="DaFlowPINN.config.html" />

    <!-- Generated with Sphinx 8.2.3 and Furo 2024.08.06 -->
        <title>DaFlowPINN.model package - DaFlowPINNs documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">DaFlowPINNs  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">DaFlowPINNs  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../home.html">DaFlowPINN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../home.html#features">ðŸš€ Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../home.html#installation">ðŸ›  Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../home.html#examples">ðŸ“‚ Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../home.html#usage">ðŸ“š Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../home.html#license">ðŸ“„ License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../home.html#references">References</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="DaFlowPINN.boundaries.html">DaFlowPINN.boundaries package</a></li>
<li class="toctree-l1"><a class="reference internal" href="DaFlowPINN.config.html">DaFlowPINN.config package</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">DaFlowPINN.model package</a></li>
<li class="toctree-l1"><a class="reference internal" href="DaFlowPINN.post.html">DaFlowPINN.post package</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="DaFlowPINN.training.html">DaFlowPINN.training package</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of DaFlowPINN.training package</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="DaFlowPINN.training.optim.html">DaFlowPINN.training.optim package</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/generated/DaFlowPINN.model.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="daflowpinn-model-package">
<h1>DaFlowPINN.model package<a class="headerlink" href="#daflowpinn-model-package" title="Link to this heading">Â¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">Â¶</a></h2>
</section>
<section id="module-DaFlowPINN.model.architectures">
<span id="daflowpinn-model-architectures-module"></span><h2>DaFlowPINN.model.architectures module<a class="headerlink" href="#module-DaFlowPINN.model.architectures" title="Link to this heading">Â¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="DaFlowPINN.model.architectures.FCN">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">DaFlowPINN.model.architectures.</span></span><span class="sig-name descname"><span class="pre">FCN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N_INPUT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_OUTPUT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_HIDDEN</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_LAYERS</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DaFlowPINN.model.architectures.FCN" title="Link to this definition">Â¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Defines a standard fully-connected network in PyTorch</p>
<dl class="py method">
<dt class="sig sig-object py" id="DaFlowPINN.model.architectures.FCN.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DaFlowPINN.model.architectures.FCN.forward" title="Link to this definition">Â¶</a></dt>
<dd><p>Forward pass through the network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>torch.Tensor</em>) â€“ Input tensor.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output tensor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="DaFlowPINN.model.architectures.HardBC">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">DaFlowPINN.model.architectures.</span></span><span class="sig-name descname"><span class="pre">HardBC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bc_fun</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0,</span> <span class="pre">0,</span> <span class="pre">0,</span> <span class="pre">0]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DaFlowPINN.model.architectures.HardBC" title="Link to this definition">Â¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Defines a hard boundary condition layer in PyTorch using a user-defined distance function. The distance function is applied only to the first 3 dimensions of the input tensor. The fourth dimension is treated as pressure and is not modified.</p>
<dl class="py method">
<dt class="sig sig-object py" id="DaFlowPINN.model.architectures.HardBC.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DaFlowPINN.model.architectures.HardBC.forward" title="Link to this definition">Â¶</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="DaFlowPINN.model.architectures.RFF">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">DaFlowPINN.model.architectures.</span></span><span class="sig-name descname"><span class="pre">RFF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_freqs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scales</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[1,</span> <span class="pre">1,</span> <span class="pre">1,</span> <span class="pre">1]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DaFlowPINN.model.architectures.RFF" title="Link to this definition">Â¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Defines a random Fourier feature layer in PyTorch. This layer is used to project the input tensor into a higher-dimensional space using random Fourier features. The projection is done using a linear transformation followed by sine and cosine transformations.</p>
<dl class="py method">
<dt class="sig sig-object py" id="DaFlowPINN.model.architectures.RFF.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DaFlowPINN.model.architectures.RFF.forward" title="Link to this definition">Â¶</a></dt>
<dd><p>Forward pass through the RFF layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>torch.Tensor</em>) â€“ Input tensor of shape (N, 4).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output tensor with random Fourier features.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DaFlowPINN.model.architectures.RFF.rff">
<span class="sig-name descname"><span class="pre">rff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DaFlowPINN.model.architectures.RFF.rff" title="Link to this definition">Â¶</a></dt>
<dd><p>Applies the random Fourier feature mapping to the input tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>torch.Tensor</em>) â€“ Input tensor of shape (N, 4).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Transformed tensor with random Fourier features.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="DaFlowPINN.model.architectures.WangResNet">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">DaFlowPINN.model.architectures.</span></span><span class="sig-name descname"><span class="pre">WangResNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N_INPUT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_OUTPUT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_HIDDEN</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_LAYERS</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DaFlowPINN.model.architectures.WangResNet" title="Link to this definition">Â¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p><a class="reference external" href="https://github.com/PredictiveIntelligenceLab/GradientPathologiesPINNs">https://github.com/PredictiveIntelligenceLab/GradientPathologiesPINNs</a></p>
<dl class="py method">
<dt class="sig sig-object py" id="DaFlowPINN.model.architectures.WangResNet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DaFlowPINN.model.architectures.WangResNet.forward" title="Link to this definition">Â¶</a></dt>
<dd><p>Define the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="module-DaFlowPINN.model.core">
<span id="daflowpinn-model-core-module"></span><h2>DaFlowPINN.model.core module<a class="headerlink" href="#module-DaFlowPINN.model.core" title="Link to this heading">Â¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.CustomDataset">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">DaFlowPINN.model.core.</span></span><span class="sig-name descname"><span class="pre">CustomDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Xdata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ydata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DaFlowPINN.model.core.CustomDataset" title="Link to this definition">Â¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.Network">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">DaFlowPINN.model.core.</span></span><span class="sig-name descname"><span class="pre">Network</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_LAYERS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_NEURONS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">512</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hardBC_sdf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fourier_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DaFlowPINN.model.core.Network" title="Link to this definition">Â¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Wrapper network for PINN models supporting optional Fourier features and hard boundary conditions.</p>
<dl class="py method">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.Network.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DaFlowPINN.model.core.Network.forward" title="Link to this definition">Â¶</a></dt>
<dd><p>Forward pass through the network, applying optional Fourier features and hard boundary conditions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>torch.Tensor</em>) â€“ Input tensor of shape (batch_size, 4).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output tensor of shape (batch_size, 4).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.PINN_3D">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">DaFlowPINN.model.core.</span></span><span class="sig-name descname"><span class="pre">PINN_3D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NAME</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Re</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_LAYERS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_NEURONS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp_enabled</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hardBC_sdf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fourier_feature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DaFlowPINN.model.core.PINN_3D" title="Link to this definition">Â¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>PINN_3D: Physics-Informed Neural Network for 3D PDEs.</p>
<p>This class implements a PINN for solving 3D partial differential equations (PDEs) using neural networks.
It supports:</p>
<blockquote>
<div><ul class="simple">
<li><p>Data-driven supervised learning (with data points)</p></li>
<li><p>Physics-based loss via collocation points (enforcing PDEs)</p></li>
<li><p>Boundary condition enforcement (soft or hard)</p></li>
<li><p>Optional Fourier feature mapping and hard boundary conditions</p></li>
<li><p>Automatic mixed precision (AMP) training</p></li>
<li><p>Collocation point growth and dynamic point updates</p></li>
<li><p>Learning rate scheduling and advanced optimizers (Adam, LBFGS, SOAP)</p></li>
<li><p>Loss weighting and auto-weighting schemes</p></li>
<li><p>Training/validation split, normalization, and non-dimensionalization</p></li>
<li><p>Plotting and evaluation utilities</p></li>
</ul>
</div></blockquote>
<dl class="py attribute">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.PINN_3D.model">
<span class="sig-name descname"><span class="pre">model</span></span><a class="headerlink" href="#DaFlowPINN.model.core.PINN_3D.model" title="Link to this definition">Â¶</a></dt>
<dd><p>The wrapped neural network (with optional Fourier features and hard BC).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Module</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.PINN_3D.NAME">
<span class="sig-name descname"><span class="pre">NAME</span></span><a class="headerlink" href="#DaFlowPINN.model.core.PINN_3D.NAME" title="Link to this definition">Â¶</a></dt>
<dd><p>Model identifier.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.PINN_3D.Re">
<span class="sig-name descname"><span class="pre">Re</span></span><a class="headerlink" href="#DaFlowPINN.model.core.PINN_3D.Re" title="Link to this definition">Â¶</a></dt>
<dd><p>Reynolds number for non-dimensionalization.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.PINN_3D.N_LAYERS">
<span class="sig-name descname"><span class="pre">N_LAYERS</span></span><a class="headerlink" href="#DaFlowPINN.model.core.PINN_3D.N_LAYERS" title="Link to this definition">Â¶</a></dt>
<dd><p>Number of layers in the neural network.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.PINN_3D.N_NEURONS">
<span class="sig-name descname"><span class="pre">N_NEURONS</span></span><a class="headerlink" href="#DaFlowPINN.model.core.PINN_3D.N_NEURONS" title="Link to this definition">Â¶</a></dt>
<dd><p>Number of neurons per layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.PINN_3D.amp_enabled">
<span class="sig-name descname"><span class="pre">amp_enabled</span></span><a class="headerlink" href="#DaFlowPINN.model.core.PINN_3D.amp_enabled" title="Link to this definition">Â¶</a></dt>
<dd><p>Enable AMP training.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.PINN_3D.device">
<span class="sig-name descname"><span class="pre">device</span></span><a class="headerlink" href="#DaFlowPINN.model.core.PINN_3D.device" title="Link to this definition">Â¶</a></dt>
<dd><p>Device for computation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.device</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.PINN_3D.N_COLLOCATION">
<span class="sig-name descname"><span class="pre">N_COLLOCATION</span></span><a class="headerlink" href="#DaFlowPINN.model.core.PINN_3D.N_COLLOCATION" title="Link to this definition">Â¶</a></dt>
<dd><p>Number of collocation (physics) points.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.PINN_3D.N_BC">
<span class="sig-name descname"><span class="pre">N_BC</span></span><a class="headerlink" href="#DaFlowPINN.model.core.PINN_3D.N_BC" title="Link to this definition">Â¶</a></dt>
<dd><p>Number of boundary condition points.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.PINN_3D.N_DATA">
<span class="sig-name descname"><span class="pre">N_DATA</span></span><a class="headerlink" href="#DaFlowPINN.model.core.PINN_3D.N_DATA" title="Link to this definition">Â¶</a></dt>
<dd><p>Number of data points.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.PINN_3D.point_update_freq">
<span class="sig-name descname"><span class="pre">point_update_freq</span></span><a class="headerlink" href="#DaFlowPINN.model.core.PINN_3D.point_update_freq" title="Link to this definition">Â¶</a></dt>
<dd><p>Frequency for updating points.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.PINN_3D.collocation_growth">
<span class="sig-name descname"><span class="pre">collocation_growth</span></span><a class="headerlink" href="#DaFlowPINN.model.core.PINN_3D.collocation_growth" title="Link to this definition">Â¶</a></dt>
<dd><p>Enable collocation growth.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.PINN_3D.epoch">
<span class="sig-name descname"><span class="pre">epoch</span></span><a class="headerlink" href="#DaFlowPINN.model.core.PINN_3D.epoch" title="Link to this definition">Â¶</a></dt>
<dd><p>Current training epoch.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.PINN_3D.model_cpu">
<span class="sig-name descname"><span class="pre">model_cpu</span></span><a class="headerlink" href="#DaFlowPINN.model.core.PINN_3D.model_cpu" title="Link to this definition">Â¶</a></dt>
<dd><p>Model copy for CPU inference.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Module</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">hist_total,</span> <span class="pre">hist_data,</span> <span class="pre">hist_ns,</span> <span class="pre">hist_bc,</span> <span class="pre">hist_lr</span></span></dt>
<dd><p>Loss and LR histories.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.PINN_3D.plot_setups">
<span class="sig-name descname"><span class="pre">plot_setups</span></span><a class="headerlink" href="#DaFlowPINN.model.core.PINN_3D.plot_setups" title="Link to this definition">Â¶</a></dt>
<dd><p>Plot configuration setups.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">l_scale,</span> <span class="pre">u_scale,</span> <span class="pre">t_scale,</span> <span class="pre">p_scale</span></span></dt>
<dd><p>Non-dimensionalization scales.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">norm_scales,</span> <span class="pre">norm_offsets</span></span></dt>
<dd><p>Normalization parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">lambda_data,</span> <span class="pre">lambda_bc,</span> <span class="pre">lambda_ns</span></span></dt>
<dd><p>Loss weights.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.PINN_3D.scheduler">
<span class="sig-name descname"><span class="pre">scheduler</span></span><a class="headerlink" href="#DaFlowPINN.model.core.PINN_3D.scheduler" title="Link to this definition">Â¶</a></dt>
<dd><p>Learning rate scheduler.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">optimizer,</span> <span class="pre">post_optimizer</span></span></dt>
<dd><p>Optimizer(s).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.PINN_3D.autoweight">
<span class="sig-name descname"><span class="pre">autoweight</span></span><a class="headerlink" href="#DaFlowPINN.model.core.PINN_3D.autoweight" title="Link to this definition">Â¶</a></dt>
<dd><p>Enable auto-weighting of losses.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.PINN_3D.grad_acc">
<span class="sig-name descname"><span class="pre">grad_acc</span></span><a class="headerlink" href="#DaFlowPINN.model.core.PINN_3D.grad_acc" title="Link to this definition">Â¶</a></dt>
<dd><p>Enable gradient accumulation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">...</span></span></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>many other training and bookkeeping attributes</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.PINN_3D.add_2D_plot">
<span class="sig-name descname"><span class="pre">add_2D_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plot_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim3_slice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_slice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">component1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">centered1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">component2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">centered2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ub</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim3_tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DaFlowPINN.model.core.PINN_3D.add_2D_plot" title="Link to this definition">Â¶</a></dt>
<dd><p>Adds a 2D plot configuration to the PINN model.
Call multiple times to add multiple plots.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>plot_dims</strong> (<em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em>) â€“ Indices of the two spatial dimensions to plot (e.g., (0, 1) for x-y).</p></li>
<li><p><strong>dim3_slice</strong> (<em>float</em>) â€“ Value at which to slice the third spatial dimension.</p></li>
<li><p><strong>t_slice</strong> (<em>float</em>) â€“ Value at which to slice the time dimension.</p></li>
<li><p><strong>plot_data</strong> (<em>bool</em><em>, </em><em>optional</em>) â€“ If True, overlay data points on the plot. Defaults to False.</p></li>
<li><p><strong>component1</strong> (<em>int</em><em>, </em><em>optional</em>) â€“ Index of the first field/component to plot. Defaults to 0.</p></li>
<li><p><strong>centered1</strong> (<em>bool</em><em>, </em><em>optional</em>) â€“ If True, center the color scale for component1. Defaults to False.</p></li>
<li><p><strong>vmin1</strong> (<em>float</em><em>, </em><em>optional</em>) â€“ Minimum value for the color scale of component1. Defaults to None.</p></li>
<li><p><strong>vmax1</strong> (<em>float</em><em>, </em><em>optional</em>) â€“ Maximum value for the color scale of component1. Defaults to None.</p></li>
<li><p><strong>component2</strong> (<em>int</em><em>, </em><em>optional</em>) â€“ Index of the second field/component to plot. Defaults to 4.</p></li>
<li><p><strong>centered2</strong> (<em>bool</em><em>, </em><em>optional</em>) â€“ If True, center the color scale for component2. Defaults to False.</p></li>
<li><p><strong>vmin2</strong> (<em>float</em><em>, </em><em>optional</em>) â€“ Minimum value for the color scale of component2. Defaults to None.</p></li>
<li><p><strong>vmax2</strong> (<em>float</em><em>, </em><em>optional</em>) â€“ Maximum value for the color scale of component2. Defaults to None.</p></li>
<li><p><strong>lb</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) â€“ Lower bounds for the plot region. Defaults to the modelâ€™s lower bounds.</p></li>
<li><p><strong>ub</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) â€“ Upper bounds for the plot region. Defaults to the modelâ€™s upper bounds.</p></li>
<li><p><strong>resolution</strong> (<em>List</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) â€“ Resolution of the plot grid as [n_x, n_y]. Defaults to [100, 100].</p></li>
<li><p><strong>dim3_tolerance</strong> (<em>float</em><em>, </em><em>optional</em>) â€“ Tolerance for showing data points in the third dimension. Defaults to 5% of the modelâ€™s third dimension range.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
<dl class="simple">
<dt>Field/component indices:</dt><dd><p>0: Magnitude of velocity (<a href="#id1"><span class="problematic" id="id2">|u|</span></a>)
1: u component of velocity
2: v component of velocity
3: w component of velocity
4: Pressure (p)
5: du1/dx
6: du1/dy
7: du2/dx
8: du2/dy
9: Vorticity
(NYI): Q-criterion</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.PINN_3D.add_boundary_condition">
<span class="sig-name descname"><span class="pre">add_boundary_condition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">surface_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_BC_POINTS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0,</span> <span class="pre">0,</span> <span class="pre">0]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_acc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DaFlowPINN.model.core.PINN_3D.add_boundary_condition" title="Link to this definition">Â¶</a></dt>
<dd><p>Adds boundary condition points for supervised boundary loss to the PINN model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surface_sampler</strong> (<em>callable</em>) â€“ Function that samples points on the boundary surface and returns their coordinates as a numpy array.</p></li>
<li><p><strong>N_BC_POINTS</strong> (<em>int</em>) â€“ Number of boundary condition points to sample.</p></li>
<li><p><strong>weight</strong> (<em>float</em>) â€“ Weight for the boundary condition loss term.</p></li>
<li><p><strong>values</strong> (<em>list</em><em>, </em><em>optional</em>) â€“ Target values for the boundary condition (default: [0, 0, 0]).</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>optional</em>) â€“ Batch size for boundary condition points (default: all points).</p></li>
<li><p><strong>n_acc</strong> (<em>int</em><em>, </em><em>optional</em>) â€“ Number of accumulations for boundary condition batches (default: 1).</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.PINN_3D.add_collocation_growth">
<span class="sig-name descname"><span class="pre">add_collocation_growth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_init</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">increase_scheme</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DaFlowPINN.model.core.PINN_3D.add_collocation_growth" title="Link to this definition">Â¶</a></dt>
<dd><p>Enables dynamic collocation point growth during training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_init</strong> (<em>int</em>) â€“ Initial number of collocation points at the start of growth.</p></li>
<li><p><strong>n_max</strong> (<em>int</em>) â€“ Maximum number of collocation points at the end of growth.</p></li>
<li><p><strong>epoch_start</strong> (<em>int</em>) â€“ Epoch at which to begin increasing the number of collocation points.</p></li>
<li><p><strong>epoch_end</strong> (<em>int</em>) â€“ Epoch at which to reach the maximum number of collocation points.</p></li>
<li><p><strong>increase_scheme</strong> (<em>str</em><em>, </em><em>optional</em>) â€“ Strategy for increasing collocation points. Defaults to â€˜linearâ€™.
- â€˜linearâ€™: Linearly increases the number of points from n_init to n_max between epoch_start and epoch_end.
- â€˜exponentialâ€™: Exponentially increases the number of points; requires â€˜epsilonâ€™ in kwargs (controls the end ratio).
- â€˜logarithmicâ€™: Logarithmically increases the number of points.</p></li>
<li><p><strong>**kwargs</strong> â€“ Additional keyword arguments for specific increase schemes (e.g., â€˜epsilonâ€™ for exponential).</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.PINN_3D.add_data_points">
<span class="sig-name descname"><span class="pre">add_data_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_test_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_acc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DaFlowPINN.model.core.PINN_3D.add_data_points" title="Link to this definition">Â¶</a></dt>
<dd><p>Adds data points for supervised learning to the PINN model, applies dimensionless transformation and normalization, and prepares train/test splits.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>np.ndarray</em>) â€“ Array containing the data points. The array should have at least 8 columns:</p></li>
<li><p><strong>0</strong> (<em>- Column</em>) â€“ Index or identifier (optional, otherwise empty column)</p></li>
<li><p><strong>1-4</strong> (<em>- Columns</em>) â€“ Input features (x, y, z, t)</p></li>
<li><p><strong>5-7</strong> (<em>- Columns</em>) â€“ Output features (u, v, w)</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>optional</em>) â€“ Batch size for training. If None, uses all data.</p></li>
<li><p><strong>test_size</strong> (<em>float</em><em>, </em><em>optional</em>) â€“ Fraction of data to use for testing. Default is 0.05.</p></li>
<li><p><strong>train_test_file</strong> (<em>str</em><em>, </em><em>optional</em>) â€“ Path to a .npz file with precomputed train/test splits.</p></li>
<li><p><strong>n_acc</strong> (<em>int</em><em>, </em><em>optional</em>) â€“ Number of batches for gradient accumulation. Default is 1.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.PINN_3D.add_optimizer">
<span class="sig-name descname"><span class="pre">add_optimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'adam'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lbfgs_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'standard'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DaFlowPINN.model.core.PINN_3D.add_optimizer" title="Link to this definition">Â¶</a></dt>
<dd><p>Adds an optimizer to the PINN model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>optim</strong> (<em>str</em><em>, </em><em>optional</em>) â€“ The optimizer to use. Defaults to â€œadamâ€.</p></li>
<li><p><strong>&quot;adam&quot;</strong> (<em>-</em>) â€“ Adam optimizer.</p></li>
<li><p><strong>&quot;sgd&quot;</strong> (<em>-</em>) â€“ Stochastic Gradient Descent optimizer.</p></li>
<li><p><strong>&quot;lbfgs&quot;</strong> (<em>-</em>) â€“ Limited-memory Broydenâ€“Fletcherâ€“Goldfarbâ€“Shanno optimizer.</p></li>
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>optional</em>) â€“ Learning rate for the optimizer. Defaults to 1e-3.</p></li>
<li><p><strong>lbfgs_type</strong> (<em>str</em><em>, </em><em>optional</em>) â€“ Type of L-BFGS optimizer (applied only when LBFGS is activated). Defaults to â€œstandardâ€.</p></li>
<li><p><strong>&quot;standard&quot;</strong> (<em>-</em>) â€“ Standard L-BFGS optimizer implemented in PyTorch</p></li>
<li><p><strong>&quot;full_overlap&quot;</strong> (<em>-</em>) â€“ Full overlap L-BFGS optimizer (see <a class="reference external" href="https://github.com/hjmshi/PyTorch-LBFGS">https://github.com/hjmshi/PyTorch-LBFGS</a>)</p></li>
<li><p><strong>&quot;multibatch&quot;</strong> (<em>-</em>) â€“ Multibatch L-BFGS optimizer with partial overlap (see <a class="reference external" href="https://github.com/hjmshi/PyTorch-LBFGS">https://github.com/hjmshi/PyTorch-LBFGS</a>)</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> â€“ If an invalid optimizer is specified.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.PINN_3D.add_physics_points">
<span class="sig-name descname"><span class="pre">add_physics_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N_COLLOCATION</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geometry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_percentage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numerical</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_acc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DaFlowPINN.model.core.PINN_3D.add_physics_points" title="Link to this definition">Â¶</a></dt>
<dd><p>Adds physics collocation points (interior points) for enforcing the PDE residual in the PINN model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>N_COLLOCATION</strong> (<em>int</em>) â€“ Number of collocation (physics) points to sample.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em>) â€“ Batch size for the physics DataLoader.</p></li>
<li><p><strong>geometry</strong> (<em>callable</em><em>, </em><em>optional</em>) â€“ Function that returns a boolean mask for points inside the domain geometry. Defaults to None.</p></li>
<li><p><strong>weight</strong> (<em>float</em><em>, </em><em>optional</em>) â€“ Weight for the physics (Navier-Stokes) loss term. Defaults to 1.0.</p></li>
<li><p><strong>keep_percentage</strong> (<em>float</em><em>, </em><em>optional</em>) â€“ Percentage of existing collocation points to retain when updating points. Defaults to 20.</p></li>
<li><p><strong>numerical</strong> (<em>bool</em><em>, </em><em>optional</em>) â€“ If True, use numerical physics loss. Defaults to False.</p></li>
<li><p><strong>p_scale</strong> (<em>float</em><em>, </em><em>optional</em>) â€“ Scaling factor for pressure normalization. Defaults to 1.</p></li>
<li><p><strong>n_acc</strong> (<em>int</em><em>, </em><em>optional</em>) â€“ Number of accumulations for physics batches. Defaults to 1.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.PINN_3D.add_postTraining">
<span class="sig-name descname"><span class="pre">add_postTraining</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lbfgs_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'standard'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DaFlowPINN.model.core.PINN_3D.add_postTraining" title="Link to this definition">Â¶</a></dt>
<dd><p>Adds an additional post-training stage using the L-BFGS optimizer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lr</strong> (<em>float</em><em>, </em><em>optional</em>) â€“ Learning rate for the L-BFGS optimizer. Defaults to 1.</p></li>
<li><p><strong>epochs</strong> (<em>int</em><em>, </em><em>optional</em>) â€“ Number of post-training epochs. Defaults to 1000.</p></li>
<li><p><strong>lbfgs_type</strong> (<em>str</em><em>, </em><em>optional</em>) â€“ Type of L-BFGS optimizer. Options are â€œstandardâ€, â€œfull_overlapâ€, or â€œmultibatchâ€. Defaults to â€œstandardâ€.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.PINN_3D.add_scheduler">
<span class="sig-name descname"><span class="pre">add_scheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scheduler</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DaFlowPINN.model.core.PINN_3D.add_scheduler" title="Link to this definition">Â¶</a></dt>
<dd><p>Adds a learning rate scheduler to the PINN model.
Set up via: PINN_3D.add_scheduler(LRScheduler(optimizer=PINN_3D.optimizer, â€¦))</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>scheduler</strong> (<em>torch.optim.lr_scheduler.LRScheduler</em>) â€“ The learning rate scheduler to use.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.PINN_3D.callback">
<span class="sig-name descname"><span class="pre">callback</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#DaFlowPINN.model.core.PINN_3D.callback" title="Link to this definition">Â¶</a></dt>
<dd><p>Callback function to print the current epoch and losses.
This function is called periodically during training to provide updates on the training progress.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.PINN_3D.compute_losses">
<span class="sig-name descname"><span class="pre">compute_losses</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#DaFlowPINN.model.core.PINN_3D.compute_losses" title="Link to this definition">Â¶</a></dt>
<dd><p>Computes the losses for the PINN model, including data loss, boundary condition loss, and physics loss.
The losses are computed and backpropagated with optional automatic mixed precision (AMP) scaling.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The total loss.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.PINN_3D.define_domain">
<span class="sig-name descname"><span class="pre">define_domain</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ub</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DaFlowPINN.model.core.PINN_3D.define_domain" title="Link to this definition">Â¶</a></dt>
<dd><p>Defines the domain boundaries for the PINN model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lb</strong> (<em>np.ndarray</em>) â€“ Lower bounds of the domain. (x, y, z, t)</p></li>
<li><p><strong>ub</strong> (<em>np.ndarray</em>) â€“ Upper bounds of the domain. (x, y, z, t)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.PINN_3D.denormalize">
<span class="sig-name descname"><span class="pre">denormalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DaFlowPINN.model.core.PINN_3D.denormalize" title="Link to this definition">Â¶</a></dt>
<dd><p>Denormalizes the input and/or output tensors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>torch.Tensor</em><em>, </em><em>optional</em>) â€“ Input tensor to be denormalized. Defaults to None.</p></li>
<li><p><strong>y</strong> (<em>torch.Tensor</em><em>, </em><em>optional</em>) â€“ Output tensor to be denormalized. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Denormalized input and/or output tensors.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[torch.Tensor, Tuple[torch.Tensor, torch.Tensor], None]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.PINN_3D.dimensionless">
<span class="sig-name descname"><span class="pre">dimensionless</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DaFlowPINN.model.core.PINN_3D.dimensionless" title="Link to this definition">Â¶</a></dt>
<dd><p>Applies dimensionless transformation to the input and/or output tensors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>torch.Tensor</em><em>, </em><em>optional</em>) â€“ Input tensor to be transformed. Defaults to None.</p></li>
<li><p><strong>y</strong> (<em>torch.Tensor</em><em>, </em><em>optional</em>) â€“ Output tensor to be transformed. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Transformed input and/or output tensors.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[torch.Tensor, Tuple[torch.Tensor, torch.Tensor], None]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.PINN_3D.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DaFlowPINN.model.core.PINN_3D.forward" title="Link to this definition">Â¶</a></dt>
<dd><p>Forward pass of the PINN model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>torch.Tensor</em>) â€“ Input tensor.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output tensor after passing through the model and redimensionalizing.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.PINN_3D.forward_cpu">
<span class="sig-name descname"><span class="pre">forward_cpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DaFlowPINN.model.core.PINN_3D.forward_cpu" title="Link to this definition">Â¶</a></dt>
<dd><p>Forward pass for the CPU model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>torch.Tensor</em>) â€“ Input tensor.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output tensor after passing through the model and redimensionalizing.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.PINN_3D.get_forward_callable">
<span class="sig-name descname"><span class="pre">get_forward_callable</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#DaFlowPINN.model.core.PINN_3D.get_forward_callable" title="Link to this definition">Â¶</a></dt>
<dd><p>Returns a callable for CPU inference with the current model state.
This function creates a deep copy of the model on the CPU, sets it to eval mode,
and returns a function that performs a forward pass using the CPU model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A function that takes a torch.Tensor as input and returns the model output.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Callable[[torch.Tensor], torch.Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.PINN_3D.get_mse_loss">
<span class="sig-name descname"><span class="pre">get_mse_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DaFlowPINN.model.core.PINN_3D.get_mse_loss" title="Link to this definition">Â¶</a></dt>
<dd><p>Computes the scaled mean squared error (MSE) loss between model predictions and targets,
performs backpropagation (with optional AMP), and returns the detached loss and gradient.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>torch.Tensor</em>) â€“ Input tensor for the model.</p></li>
<li><p><strong>y</strong> (<em>torch.Tensor</em>) â€“ Target tensor.</p></li>
<li><p><strong>flat_grad</strong> (<em>bool</em><em>, </em><em>optional</em>) â€“ If True, returns the gradient as a flat vector. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The detached loss tensor and the gradient tensor (possibly flattened).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[torch.Tensor, torch.Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.PINN_3D.get_physics_loss">
<span class="sig-name descname"><span class="pre">get_physics_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DaFlowPINN.model.core.PINN_3D.get_physics_loss" title="Link to this definition">Â¶</a></dt>
<dd><p>Computes the physics (Navier-Stokes) loss for the given collocation points and returns the loss and its gradient.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>torch.Tensor</em>) â€“ Collocation points (physics points) as input tensor.</p></li>
<li><p><strong>flat_grad</strong> (<em>bool</em><em>, </em><em>optional</em>) â€“ If True, returns the gradient as a flat vector. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The detached physics loss tensor and the gradient tensor (possibly flattened).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[torch.Tensor, torch.Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.PINN_3D.lbfgs_step">
<span class="sig-name descname"><span class="pre">lbfgs_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DaFlowPINN.model.core.PINN_3D.lbfgs_step" title="Link to this definition">Â¶</a></dt>
<dd><p>Performs a single optimization step using the specified L-BFGS type.
:type optimizer: 
:param optimizer: The L-BFGS optimizer instance.</p>
<p>This method checks the L-BFGS type and calls the appropriate step function for standard, full-overlap, or multi-batch L-BFGS.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.PINN_3D.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DaFlowPINN.model.core.PINN_3D.load" title="Link to this definition">Â¶</a></dt>
<dd><p>Loads a trained model from the specified path.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> (<em>str</em>) â€“ Path to load the trained model.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.PINN_3D.normalize">
<span class="sig-name descname"><span class="pre">normalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DaFlowPINN.model.core.PINN_3D.normalize" title="Link to this definition">Â¶</a></dt>
<dd><p>Normalizes the input and/or output tensors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>torch.Tensor</em><em>, </em><em>optional</em>) â€“ Input tensor to be normalized. Defaults to None.</p></li>
<li><p><strong>y</strong> (<em>torch.Tensor</em><em>, </em><em>optional</em>) â€“ Output tensor to be normalized. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Normalized input and/or output tensors.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[torch.Tensor, Tuple[torch.Tensor, torch.Tensor], None]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.PINN_3D.plot_field">
<span class="sig-name descname"><span class="pre">plot_field</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#DaFlowPINN.model.core.PINN_3D.plot_field" title="Link to this definition">Â¶</a></dt>
<dd><p>Plots the field for the PINN model using the specified plot setups.
This function saves the model, loads it on the CPU, and generates 2D plots based on the provided configurations.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.PINN_3D.plot_history">
<span class="sig-name descname"><span class="pre">plot_history</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#DaFlowPINN.model.core.PINN_3D.plot_history" title="Link to this definition">Â¶</a></dt>
<dd><p>Plots the training history for the PINN model.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
<dl class="simple">
<dt>This includes:</dt><dd><ul class="simple">
<li><p>Total loss, data loss, boundary condition loss, and Navier-Stokes loss over epochs.</p></li>
<li><p>Learning rate history if a scheduler is used.</p></li>
<li><p>Loss weights (lambdas) if auto-weighting is enabled.</p></li>
<li><p>Test RMSE curves if available.</p></li>
<li><p>Maximum nondimensional pressure history if available.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.PINN_3D.redimension">
<span class="sig-name descname"><span class="pre">redimension</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DaFlowPINN.model.core.PINN_3D.redimension" title="Link to this definition">Â¶</a></dt>
<dd><p>Applies redimensionalization to the input and/or output tensors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>torch.Tensor</em><em>, </em><em>optional</em>) â€“ Input tensor to be redimensionalized. Defaults to None.</p></li>
<li><p><strong>y</strong> (<em>torch.Tensor</em><em>, </em><em>optional</em>) â€“ Output tensor to be redimensionalized. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Redimensionalized input and/or output tensors.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[torch.Tensor, Tuple[torch.Tensor, torch.Tensor], None]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.PINN_3D.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DaFlowPINN.model.core.PINN_3D.save" title="Link to this definition">Â¶</a></dt>
<dd><p>Saves the trained model to the specified path.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> (<em>str</em>) â€“ Path to save the trained model.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.PINN_3D.save_hist">
<span class="sig-name descname"><span class="pre">save_hist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DaFlowPINN.model.core.PINN_3D.save_hist" title="Link to this definition">Â¶</a></dt>
<dd><p>Saves the loss history to a specified path.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> (<em>str</em>) â€“ Path to save the loss history.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.PINN_3D.set_dimensionless">
<span class="sig-name descname"><span class="pre">set_dimensionless</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l_scale</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u_scale</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_scale</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DaFlowPINN.model.core.PINN_3D.set_dimensionless" title="Link to this definition">Â¶</a></dt>
<dd><p>Sets the dimensionless scales for the PINN model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>l_scale</strong> (<em>float</em>) â€“ Length scale for non-dimensionalization. l* = l / l_scale</p></li>
<li><p><strong>u_scale</strong> (<em>float</em>) â€“ Velocity scale for non-dimensionalization. u* = u / u_scale</p></li>
<li><p><strong>p_scale</strong> (<em>float</em>) â€“ Pressure scale for non-dimensionalization. p* = p / p_scale
- for high viscosity flows, p_scale = Î¼ * u_scale / l_scale
- for high velocity flows, p_scale = Ï * u_scale^2</p></li>
<li><p><strong>t_scale</strong> (<em>float</em><em>, </em><em>optional</em>) â€“ Time scale for non-dimensionalization. t* = t / t_scale (If not provided, it is calculated as l_scale / u_scale.)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.PINN_3D.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#DaFlowPINN.model.core.PINN_3D.step" title="Link to this definition">Â¶</a></dt>
<dd><p>Performs a single optimization step for the PINN model.
This function computes the losses, updates the optimizer, and records the loss history.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.PINN_3D.step_full_overlap_LBFGS">
<span class="sig-name descname"><span class="pre">step_full_overlap_LBFGS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DaFlowPINN.model.core.PINN_3D.step_full_overlap_LBFGS" title="Link to this definition">Â¶</a></dt>
<dd><p>Performs a single step of the full-overlap L-BFGS optimizer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>optimizer</strong> â€“ The L-BFGS optimizer instance.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
<p>This method handles the full-overlap L-BFGS step, including line search and warm-up learning rate scheduling.
It defines a closure for the optimizer, computes the current loss and gradient, performs the optimizer step,
and updates the curvature pairs.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.PINN_3D.step_multibatch_LBFGS">
<span class="sig-name descname"><span class="pre">step_multibatch_LBFGS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DaFlowPINN.model.core.PINN_3D.step_multibatch_LBFGS" title="Link to this definition">Â¶</a></dt>
<dd><p>Performs a single optimization step using a multi-batch L-BFGS approach with overlapping batches for data,
boundary conditions, and physics constraints.
:type optimizer: 
:param optimizer: An L-BFGS optimizer instance with custom methods for two-loop recursion and curvature updates.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
<dl class="simple">
<dt>Workflow:</dt><dd><ul class="simple">
<li><p>Defines an overlap ratio for batches and splits each batch into main and overlapping parts.</p></li>
<li><p>Computes losses and gradients for each batch and its overlap for data, boundary, and physics terms.</p></li>
<li><p>Aggregates gradients and losses using a weighted combination that accounts for overlap.</p></li>
<li><p>Handles warm-up epochs with a custom learning rate schedule.</p></li>
<li><p>Optionally updates loss weights if automatic weighting is enabled.</p></li>
<li><p>Stores previous batch gradients and losses for use in the next step.</p></li>
<li><p>Updates the optimizerâ€™s curvature information for L-BFGS.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Assumes the existence of attributes such as N_DATA, N_BC, N_COLLOCATION, dataloader, bc_dataloader,
physics_dataloader, lambda_data, lambda_bc, lambda_ns, WeightUpdater, and others.</p></li>
<li><p>Requires that the optimizer supports custom methods: two_loop_recursion, step, and curvature_update.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.PINN_3D.step_standard_LBFGS">
<span class="sig-name descname"><span class="pre">step_standard_LBFGS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DaFlowPINN.model.core.PINN_3D.step_standard_LBFGS" title="Link to this definition">Â¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.PINN_3D.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epochs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">point_update_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">point_keep_percentage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">autoweight_scheme</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">autoweight_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DaFlowPINN.model.core.PINN_3D.train" title="Link to this definition">Â¶</a></dt>
<dd><p>Trains the PINN model for a specified number of epochs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>epochs</strong> (<em>int</em>) â€“ Number of epochs to train the model.</p></li>
<li><p><strong>print_freq</strong> (<em>int</em><em>, </em><em>optional</em>) â€“ Frequency (in epochs) to print training progress. Defaults to 100.</p></li>
<li><p><strong>plot_freq</strong> (<em>int</em><em>, </em><em>optional</em>) â€“ Frequency (in epochs) to plot loss history and field. Defaults to 500.</p></li>
<li><p><strong>point_update_freq</strong> (<em>int</em><em>, </em><em>optional</em>) â€“ Frequency (in epochs) to update collocation and boundary points. Defaults to None (no update).</p></li>
<li><p><strong>point_keep_percentage</strong> (<em>float</em><em>, </em><em>optional</em>) â€“ Percentage of collocation points to keep when updating points. Defaults to 20.</p></li>
<li><p><strong>autoweight_scheme</strong> (<em>str</em><em> or </em><em>None</em><em>, </em><em>optional</em>) â€“ Scheme for automatic loss weighting. Defaults to None (no auto-weighting).
- 1: ConflictFree
- 2: Wang 2023 (gradient norms)
- 3: Wang 2021 (Data loss weight is set to 1)
- 4: Wang 2021 (PDE weight is set to 1)</p></li>
<li><p><strong>autoweight_freq</strong> (<em>int</em><em>, </em><em>optional</em>) â€“ Frequency (in epochs) to update loss weights if auto-weighting is enabled. Defaults to 10.</p></li>
<li><p><strong>save_freq</strong> (<em>int</em><em>, </em><em>optional</em>) â€“ Frequency (in epochs) to save model checkpoints. Defaults to 50.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.PINN_3D.update_all">
<span class="sig-name descname"><span class="pre">update_all</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#DaFlowPINN.model.core.PINN_3D.update_all" title="Link to this definition">Â¶</a></dt>
<dd><p>Updates the training state of the model at each epoch.
This method performs the following operations:
- Checks for NaN or excessively large loss values. If detected, restores the last best model checkpoint and stops training.
- Saves the model checkpoint if the current loss improves upon the best recorded loss at specified intervals.
- Steps the learning rate scheduler if available.
- Records the current losses, lambda weights, and learning rate history.
- Periodically updates training points if point update frequency is set.
- Prints callback information and plots training history at specified intervals.
- Plots the loss history and model field at specified intervals.
Side Effects:</p>
<blockquote>
<div><ul class="simple">
<li><p>May restore model state from disk.</p></li>
<li><p>May save model state to disk.</p></li>
<li><p>Updates internal history lists.</p></li>
<li><p>May print to stdout and generate plots.</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.PINN_3D.update_points">
<span class="sig-name descname"><span class="pre">update_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keep_percentage</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DaFlowPINN.model.core.PINN_3D.update_points" title="Link to this definition">Â¶</a></dt>
<dd><p>Updates the collocation and boundary points for the PINN model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>keep_percentage</strong> (<em>float</em>) â€“ Percentage of existing collocation points to retain when updating points.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.load_predictable">
<span class="sig-prename descclassname"><span class="pre">DaFlowPINN.model.core.</span></span><span class="sig-name descname"><span class="pre">load_predictable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DaFlowPINN.model.core.load_predictable" title="Link to this definition">Â¶</a></dt>
<dd><p>Loads a saved PINN_3D model from the specified path.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> (<em>str</em>) â€“ Path to the saved model file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The loaded PINN_3D model instance with weights and configuration restored.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#DaFlowPINN.model.core.PINN_3D" title="DaFlowPINN.model.core.PINN_3D">PINN_3D</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.sample_interior_points">
<span class="sig-prename descclassname"><span class="pre">DaFlowPINN.model.core.</span></span><span class="sig-name descname"><span class="pre">sample_interior_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geometry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DaFlowPINN.model.core.sample_interior_points" title="Link to this definition">Â¶</a></dt>
<dd><p>Samples interior points within the specified domain using Latin Hypercube Sampling (LHS).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nb</strong> (<em>int</em>) â€“ Number of points to sample.</p></li>
<li><p><strong>lb</strong> (<em>np.ndarray</em>) â€“ Lower bounds of the domain.</p></li>
<li><p><strong>ub</strong> (<em>np.ndarray</em>) â€“ Upper bounds of the domain.</p></li>
<li><p><strong>geometry</strong> (<em>callable</em><em>, </em><em>optional</em>) â€“ Function to define the geometry of the domain. Should return True if a point is inside the domain and False if a point is outside the domain. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array of sampled points within the domain.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="DaFlowPINN.model.core.save_predictable">
<span class="sig-prename descclassname"><span class="pre">DaFlowPINN.model.core.</span></span><span class="sig-name descname"><span class="pre">save_predictable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">PINN</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#DaFlowPINN.model.core.save_predictable" title="Link to this definition">Â¶</a></dt>
<dd><p>Saves the PINN model to the specified path. Doesnâ€™t work with SDF yet.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>PINN</em>) â€“ The PINN model to save.</p></li>
<li><p><strong>path</strong> (<em>str</em>) â€“ Path to save the PINN model.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-DaFlowPINN.model">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-DaFlowPINN.model" title="Link to this heading">Â¶</a></h2>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="DaFlowPINN.post.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">DaFlowPINN.post package</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="DaFlowPINN.config.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">DaFlowPINN.config package</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, Jonas Pelz
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">DaFlowPINN.model package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-DaFlowPINN.model.architectures">DaFlowPINN.model.architectures module</a><ul>
<li><a class="reference internal" href="#DaFlowPINN.model.architectures.FCN"><code class="docutils literal notranslate"><span class="pre">FCN</span></code></a><ul>
<li><a class="reference internal" href="#DaFlowPINN.model.architectures.FCN.forward"><code class="docutils literal notranslate"><span class="pre">FCN.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#DaFlowPINN.model.architectures.HardBC"><code class="docutils literal notranslate"><span class="pre">HardBC</span></code></a><ul>
<li><a class="reference internal" href="#DaFlowPINN.model.architectures.HardBC.forward"><code class="docutils literal notranslate"><span class="pre">HardBC.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#DaFlowPINN.model.architectures.RFF"><code class="docutils literal notranslate"><span class="pre">RFF</span></code></a><ul>
<li><a class="reference internal" href="#DaFlowPINN.model.architectures.RFF.forward"><code class="docutils literal notranslate"><span class="pre">RFF.forward()</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.architectures.RFF.rff"><code class="docutils literal notranslate"><span class="pre">RFF.rff()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#DaFlowPINN.model.architectures.WangResNet"><code class="docutils literal notranslate"><span class="pre">WangResNet</span></code></a><ul>
<li><a class="reference internal" href="#DaFlowPINN.model.architectures.WangResNet.forward"><code class="docutils literal notranslate"><span class="pre">WangResNet.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-DaFlowPINN.model.core">DaFlowPINN.model.core module</a><ul>
<li><a class="reference internal" href="#DaFlowPINN.model.core.CustomDataset"><code class="docutils literal notranslate"><span class="pre">CustomDataset</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.Network"><code class="docutils literal notranslate"><span class="pre">Network</span></code></a><ul>
<li><a class="reference internal" href="#DaFlowPINN.model.core.Network.forward"><code class="docutils literal notranslate"><span class="pre">Network.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.PINN_3D"><code class="docutils literal notranslate"><span class="pre">PINN_3D</span></code></a><ul>
<li><a class="reference internal" href="#DaFlowPINN.model.core.PINN_3D.model"><code class="docutils literal notranslate"><span class="pre">PINN_3D.model</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.PINN_3D.NAME"><code class="docutils literal notranslate"><span class="pre">PINN_3D.NAME</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.PINN_3D.Re"><code class="docutils literal notranslate"><span class="pre">PINN_3D.Re</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.PINN_3D.N_LAYERS"><code class="docutils literal notranslate"><span class="pre">PINN_3D.N_LAYERS</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.PINN_3D.N_NEURONS"><code class="docutils literal notranslate"><span class="pre">PINN_3D.N_NEURONS</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.PINN_3D.amp_enabled"><code class="docutils literal notranslate"><span class="pre">PINN_3D.amp_enabled</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.PINN_3D.device"><code class="docutils literal notranslate"><span class="pre">PINN_3D.device</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.PINN_3D.N_COLLOCATION"><code class="docutils literal notranslate"><span class="pre">PINN_3D.N_COLLOCATION</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.PINN_3D.N_BC"><code class="docutils literal notranslate"><span class="pre">PINN_3D.N_BC</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.PINN_3D.N_DATA"><code class="docutils literal notranslate"><span class="pre">PINN_3D.N_DATA</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.PINN_3D.point_update_freq"><code class="docutils literal notranslate"><span class="pre">PINN_3D.point_update_freq</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.PINN_3D.collocation_growth"><code class="docutils literal notranslate"><span class="pre">PINN_3D.collocation_growth</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.PINN_3D.epoch"><code class="docutils literal notranslate"><span class="pre">PINN_3D.epoch</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.PINN_3D.model_cpu"><code class="docutils literal notranslate"><span class="pre">PINN_3D.model_cpu</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.PINN_3D.plot_setups"><code class="docutils literal notranslate"><span class="pre">PINN_3D.plot_setups</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.PINN_3D.scheduler"><code class="docutils literal notranslate"><span class="pre">PINN_3D.scheduler</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.PINN_3D.autoweight"><code class="docutils literal notranslate"><span class="pre">PINN_3D.autoweight</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.PINN_3D.grad_acc"><code class="docutils literal notranslate"><span class="pre">PINN_3D.grad_acc</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.PINN_3D.add_2D_plot"><code class="docutils literal notranslate"><span class="pre">PINN_3D.add_2D_plot()</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.PINN_3D.add_boundary_condition"><code class="docutils literal notranslate"><span class="pre">PINN_3D.add_boundary_condition()</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.PINN_3D.add_collocation_growth"><code class="docutils literal notranslate"><span class="pre">PINN_3D.add_collocation_growth()</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.PINN_3D.add_data_points"><code class="docutils literal notranslate"><span class="pre">PINN_3D.add_data_points()</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.PINN_3D.add_optimizer"><code class="docutils literal notranslate"><span class="pre">PINN_3D.add_optimizer()</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.PINN_3D.add_physics_points"><code class="docutils literal notranslate"><span class="pre">PINN_3D.add_physics_points()</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.PINN_3D.add_postTraining"><code class="docutils literal notranslate"><span class="pre">PINN_3D.add_postTraining()</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.PINN_3D.add_scheduler"><code class="docutils literal notranslate"><span class="pre">PINN_3D.add_scheduler()</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.PINN_3D.callback"><code class="docutils literal notranslate"><span class="pre">PINN_3D.callback()</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.PINN_3D.compute_losses"><code class="docutils literal notranslate"><span class="pre">PINN_3D.compute_losses()</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.PINN_3D.define_domain"><code class="docutils literal notranslate"><span class="pre">PINN_3D.define_domain()</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.PINN_3D.denormalize"><code class="docutils literal notranslate"><span class="pre">PINN_3D.denormalize()</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.PINN_3D.dimensionless"><code class="docutils literal notranslate"><span class="pre">PINN_3D.dimensionless()</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.PINN_3D.forward"><code class="docutils literal notranslate"><span class="pre">PINN_3D.forward()</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.PINN_3D.forward_cpu"><code class="docutils literal notranslate"><span class="pre">PINN_3D.forward_cpu()</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.PINN_3D.get_forward_callable"><code class="docutils literal notranslate"><span class="pre">PINN_3D.get_forward_callable()</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.PINN_3D.get_mse_loss"><code class="docutils literal notranslate"><span class="pre">PINN_3D.get_mse_loss()</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.PINN_3D.get_physics_loss"><code class="docutils literal notranslate"><span class="pre">PINN_3D.get_physics_loss()</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.PINN_3D.lbfgs_step"><code class="docutils literal notranslate"><span class="pre">PINN_3D.lbfgs_step()</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.PINN_3D.load"><code class="docutils literal notranslate"><span class="pre">PINN_3D.load()</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.PINN_3D.normalize"><code class="docutils literal notranslate"><span class="pre">PINN_3D.normalize()</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.PINN_3D.plot_field"><code class="docutils literal notranslate"><span class="pre">PINN_3D.plot_field()</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.PINN_3D.plot_history"><code class="docutils literal notranslate"><span class="pre">PINN_3D.plot_history()</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.PINN_3D.redimension"><code class="docutils literal notranslate"><span class="pre">PINN_3D.redimension()</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.PINN_3D.save"><code class="docutils literal notranslate"><span class="pre">PINN_3D.save()</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.PINN_3D.save_hist"><code class="docutils literal notranslate"><span class="pre">PINN_3D.save_hist()</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.PINN_3D.set_dimensionless"><code class="docutils literal notranslate"><span class="pre">PINN_3D.set_dimensionless()</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.PINN_3D.step"><code class="docutils literal notranslate"><span class="pre">PINN_3D.step()</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.PINN_3D.step_full_overlap_LBFGS"><code class="docutils literal notranslate"><span class="pre">PINN_3D.step_full_overlap_LBFGS()</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.PINN_3D.step_multibatch_LBFGS"><code class="docutils literal notranslate"><span class="pre">PINN_3D.step_multibatch_LBFGS()</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.PINN_3D.step_standard_LBFGS"><code class="docutils literal notranslate"><span class="pre">PINN_3D.step_standard_LBFGS()</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.PINN_3D.train"><code class="docutils literal notranslate"><span class="pre">PINN_3D.train()</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.PINN_3D.update_all"><code class="docutils literal notranslate"><span class="pre">PINN_3D.update_all()</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.PINN_3D.update_points"><code class="docutils literal notranslate"><span class="pre">PINN_3D.update_points()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.load_predictable"><code class="docutils literal notranslate"><span class="pre">load_predictable()</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.sample_interior_points"><code class="docutils literal notranslate"><span class="pre">sample_interior_points()</span></code></a></li>
<li><a class="reference internal" href="#DaFlowPINN.model.core.save_predictable"><code class="docutils literal notranslate"><span class="pre">save_predictable()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-DaFlowPINN.model">Module contents</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    </body>
</html>